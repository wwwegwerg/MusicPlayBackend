# План backend проекта

Хочу, чтобы ты написал для меня максимально простой, но аккуратно структурированный backend-проект.

## Технологии

NestJS (TypeScript)  
Prisma ORM  
PostgreSQL  
npm как пакетный менеджер
Использование Nest CLI для создания и структурирования проекта

## Задача

Реализовать минимальное API для регистрации и логина пользователей.

## Функциональные требования

### Пользовательская модель

Поля: id, username, password, createdAt, updatedAt.  
id: UUID.  
username уникальный.  
password хранится только в захэшированном виде, не в открытом виде.

### Регистрация POST /auth/register

Принимает: username, password.  
Валидирует username (не пустой, разумная максимальная длина) и минимальную длину пароля (например, 6 символов).  
Проверяет, что username еще не занят.  
Хэширует пароль (bcrypt или аналог).  
Сохраняет пользователя в базе.  
Возвращает информацию о пользователе без поля password и при необходимости JWT токен.

### Логин POST /auth/login

Принимает: username, password.  
Находит пользователя по username.  
Сравнивает пароль с хэшем.  
В случае успеха возвращает JWT токен.  
В случае ошибки возвращает корректный HTTP статус и сообщение, например 401 при неправильных данных.

### Авторизация

Использовать JWT access token с секретом из переменной окружения.  
Срок жизни токена, например 1 час, можно зашить или сделать настройкой.

Охраняемый маршрут для проверки авторизации, например GET /auth/me или GET /users/me.  
Доступен только с валидным Bearer токеном.  
Возвращает текущего пользователя.

### Обработка ошибок

Использовать стандартные механизмы NestJS, такие как HttpException и встроенные фильтры.  
Писать понятные сообщения об ошибках при регистрации и логине.

## Требования по структуре проекта

### NestJS

Создать модуль AuthModule.  
Внутри: AuthController, AuthService, Guard для JWT, стратегия JwtStrategy.  
При необходимости создать UsersModule и UsersService для работы с пользователями.

### Prisma

Описать схему в schema.prisma для модели User с полями id (UUID), username, password, createdAt, updatedAt.  
Настроить datasource для PostgreSQL.  
Прописать команды для миграций, например prisma migrate dev.  
Показать пример файла .env с переменной DATABASE_URL как шаблон, без реальных паролей.

## Конфигурация

Добавить пример .env с переменными:  
DATABASE_URL  
JWT_SECRET

Использовать @nestjs/config или другой удобный механизм конфигурации для работы с переменными окружения.
